#!/bin/bash

# Проверяем, передан ли параметр (количество запросов)
if [ -z "$1" ]; then
    echo "Использование: $0 <количество_запросов>"
    exit 1
fi

REQUESTS=$1  # Количество запросов из первого аргумента
CONCURRENCY=10  # Количество одновременных соединений

# Проверяем, установлена ли утилита hey
if ! command -v hey &> /dev/null
then
    echo "Ошибка: утилита 'hey' не найдена. Установите её с помощью 'sudo snap install hey' или 'go install github.com/rakyll/hey@latest'"
    exit 1
fi

# Запускаем тест с переданным количеством запросов
hey -n "$REQUESTS" -c "$CONCURRENCY" http://127.0.0.1:8080/

# Выводим сообщение о завершении теста
echo "Нагрузочное тестирование завершено."
